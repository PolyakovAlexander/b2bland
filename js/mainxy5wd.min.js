!function(a){a.MaskedInput=function(f){if(!f||!f.elm||!f.format)return null;if(!(this instanceof a.MaskedInput))return new a.MaskedInput(f);var o=this,d=f.elm,s=f.format,i=f.allowed||"0123456789",h=f.allowedfx||function(){return!0},p=f.separator||"/:-",n=f.typeon||"_YMDhms",c=f.onbadkey||function(){},q=f.onfilled||function(){},w=f.badkeywait||0,A=!f.hasOwnProperty("preserve")||!!f.preserve,l=!0,y=!1,t=s,j=window.addEventListener?function(E,C,D,B){E.addEventListener(C,D,void 0!==B&&B)}:window.attachEvent?function(D,B,C){D.attachEvent("on"+B,C)}:function(D,B,C){D["on"+B]=C},u=function(){for(var B=d.value.length-1;B>=0;B--)for(var D=0,C=n.length;D<C;D++)if(d.value[B]===n[D])return!1;return!0},x=function(C){try{return C.focus(),C.selectionStart>=0?C.selectionStart:document.selection?-document.selection.createRange().moveStart("character",-C.value.length):-1}catch(D){return-1}},b=function(C,E){try{if(C.selectionStart)C.focus(),C.setSelectionRange(E,E);else if(C.createTextRange){var B=C.createTextRange();B.move("character",E),B.select()}}catch(D){return!1}return!0},m=function(D){var C="",E=(D=D||window.event).which,B=D.type;if(null==E&&(E=D.keyCode),null==E)return"";switch(E){case 8:C="bksp";break;case 46:C="keydown"===B?"del":".";break;case 16:C="shift";break;case 0:case 9:case 13:C="etc";break;case 37:case 38:case 39:case 40:C=D.shiftKey||39===D.charCode||void 0===D.charCode?String.fromCharCode(E):"etc";break;default:C=String.fromCharCode(E)}return C},v=function(B,C){B.preventDefault&&B.preventDefault(),B.returnValue=C||!1},k=function(B){var D=x(d),F=d.value,E="";switch(!0){case-1!==i.indexOf(B):if((D+=1)>s.length)return!1;for(;-1!==p.indexOf(F.charAt(D-1))&&D<=s.length;)D+=1;if(!h(B,D))return c(B),!1;E=F.substr(0,D-1)+B+F.substr(D),-1===i.indexOf(F.charAt(D))&&-1===n.indexOf(F.charAt(D))&&(D+=1);break;case"bksp"===B:if((D-=1)<0)return!1;for(;-1===i.indexOf(F.charAt(D))&&-1===n.indexOf(F.charAt(D))&&D>1;)D-=1;E=F.substr(0,D)+s.substr(D,1)+F.substr(D+1);break;case"del"===B:if(D>=F.length)return!1;for(;-1!==p.indexOf(F.charAt(D))&&""!==F.charAt(D);)D+=1;E=F.substr(0,D)+s.substr(D,1)+F.substr(D+1),D+=1;break;case"etc"===B:return!0;default:return!1}return d.value="",d.value=E,b(d,D),!1},e=function(C){if(!l)return!0;if(C=C||event,y)return v(C),!1;var B=m(C);return!!("etc"===B||C.metaKey||C.ctrlKey||C.altKey)||"bksp"!==B&&"del"!==B&&"shift"!==B&&(function(B){if(-1===i.indexOf(B)&&"bksp"!==B&&"del"!==B&&"etc"!==B){var C=x(d);return y=!0,c(B),setTimeout((function(){y=!1,b(d,C)}),w),!1}return!0}(B)?k(B)?(u()&&q(),v(C,!0),!0):(u()&&q(),v(C),!1):(v(C),!1))};return o.resetField=function(){d.value=s},o.setAllowed=function(B){i=B,o.resetField()},o.setFormat=function(B){s=B,o.resetField()},o.setSeparator=function(B){p=B,o.resetField()},o.setTypeon=function(B){n=B,o.resetField()},o.setEnabled=function(B){l=B},!d.tagName||"INPUT"!==d.tagName.toUpperCase()&&"TEXTAREA"!==d.tagName.toUpperCase()?null:(A&&""!==d.value||(d.value=s),j(d,"keydown",(function(B){!function(C){if(!l)return!0;if(C=C||event,y)return v(C),!1;var B=m(C);!C.metaKey&&!C.ctrlKey||"X"!==B&&"V"!==B?C.metaKey||C.ctrlKey||(""===d.value&&(d.value=s,b(d,0)),"bksp"!==B&&"del"!==B||(k(B),v(C))):v(C)}(B)})),j(d,"keypress",(function(B){e(B)})),j(d,"focus",(function(){t=d.value})),j(d,"blur",(function(){d.value!==t&&d.onchange&&d.onchange()})),o)}}(window);